<project name="SnapTwitterExample" app="Snap! 4.0, http://snap.berkeley.edu" version="1"><notes></notes><thumbnail>data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAB4CAYAAAB1ovlvAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAIgSURBVHhe7dgha1ZRHMDhM9+ZDK5MEJMwbBrG6rIgGJxB9g38Bga/gBpnEQZ+AIPBYNJkEnHBajIalsV3L+jGLoif4Lf35XnKPef804Hfhctd+3NqQOTS9ISEAEkJkJQASQmQlABJCZCUAEkJkJQASQmQlABJCZCUAEkJkJQASQmQlABJCZCUAEkJkJQASQmQlABJCZCUAEkJkJQASQmQlABJCZCUAEkJkJQASQmQlABJCZCUAEkJkJQASQmQlABJCZCUAEkJkJQASQmQlABJCZCUAEkJkJQASQmQlABJCZCUAEkJkJQASQmQlABJCZCUAEkJkJQASQmQlABJCZDU0ge4WCymFcto6QNcX18fP+9ujuc7N8a3L5/HfD6fJiyDtT+npvXSOj4+Hhv7N8ds7Xy/OH2vnsxuj6ev34yrm9fGbDY7H3DhrESAZz59/DB2X+xNu/99P7k8Xt7aGwevDqcTLoqVCPDsCl93N8bOlX9X+TVm42B+fTw8fDe2tramUy6alQjw7f07497vH+P9ycZYe/xsPHi0P0246JY+wKOjo7G9vT3tWDYr8w3IcvIjmpQASQmQlABJCZCUAEkJkJQASQmQlABJCZCUAEkJkJQASQmQlABJCZCUAEkJkJQASQmQlABJCZCUAEkJkJQASQmQlABJCZCUAEkJkJQASQmQlABJCZCUAEkJkJQASQmQlABJCZCUAEkJkJQACY3xF35bSj9E2yRyAAAAAElFTkSuQmCC</thumbnail><stage name="Stage" width="480" height="360" costume="0" tempo="60" threadsafe="false" lines="round" codify="false" inheritance="false" scheduled="false" id="1"><pentrails>data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAFoCAYAAACPNyggAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAK1SURBVHhe7cExAQAAAMKg9U9tDB8gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgIsajf4AAXBXLv8AAAAASUVORK5CYII=</pentrails><costumes><list id="2"></list></costumes><sounds><list id="3"></list></sounds><variables></variables><blocks></blocks><scripts></scripts><sprites><sprite name="Sprite" idx="1" x="-64.47025996533784" y="-34.933208354733836" heading="90" scale="1" rotation="1" draggable="true" costume="0" color="255,70,13" pen="tip" id="8"><costumes><list id="9"></list></costumes><sounds><list id="10"></list></sounds><variables></variables><blocks></blocks><scripts><script x="250.45454545454544" y="68.72727272727272"><block s="receiveGo"></block><custom-block s="twitter: prepare"></custom-block><custom-block s="twitter: connect to stream"></custom-block><custom-block s="twitter: stamp map image"></custom-block><block s="setColor"><color>255,70,13,1</color></block><custom-block s="for each tweet do %cs"><script><custom-block s="twitter: show tweet %txt on map"><l></l></custom-block><block s="doIf"><block s="reportKeyPressed"><l><option>x</option></l></block><script><block s="doStopThis"><l><option>this script</option></l></block></script></block></script></custom-block></script><script x="500.45454545454544" y="56.72727272727306"><block s="receiveKey"><l><option>x</option></l></block><custom-block s="twitter: disconnect from stream"></custom-block></script></scripts></sprite></sprites></stage><hidden></hidden><headers></headers><code></code><blocks><block-definition s="twitter: get tweet as JSON" type="reporter" category="sensing"><header></header><code></code><inputs></inputs><script><block s="doDeclareVariables"><list><l>tw</l></list></block><block s="doSetVar"><l>tw</l><custom-block s="twitter: get from helper command %s"><l>getTweet</l></custom-block></block><block s="doIf"><block s="reportEquals"><block var="tw"/><l></l></block><script></script></block><block s="doReport"><block var="tw"/></block></script></block-definition><block-definition s="twitter: read text from tweet %&apos;tw&apos;" type="reporter" category="sensing"><header></header><code></code><inputs><input type="%s"></input></inputs><script><block s="doReport"><custom-block s="twitter: read %txt from tweet %s"><l>text</l><block var="tw"/></custom-block></block></script></block-definition><block-definition s="text %&apos;t&apos; contains %&apos;k&apos;" type="predicate" category="operators"><header></header><code></code><inputs><input type="%txt"></input><input type="%txt"></input></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>tw</l><l>kw</l></list><l>pos = tw.toLowerCase().indexOf(kw.toLowerCase()); return pos &gt; -1;</l></block><list><block var="t"/><block var="k"/></list></block></block></script></block-definition><block-definition s="twitter: show tweet %&apos;t&apos; on map" type="command" category="pen"><header></header><code></code><inputs><input type="%txt"></input></inputs><script><block s="doDeclareVariables"><list><l>coords</l></list></block><block s="doSetVar"><l>coords</l><block s="reportTextSplit"><custom-block s="twitter: read geo from tweet %s"><block var="t"/></custom-block><l>,</l></block></block><custom-block s="show marker at longitude %s latitude %s"><block s="reportListItem"><l>1</l><block var="coords"/></block><block s="reportListItem"><l>2</l><block var="coords"/></block></custom-block></script></block-definition><block-definition s="twitter: read geo from tweet %&apos;tw&apos;" type="reporter" category="sensing"><header></header><code></code><inputs><input type="%s"></input></inputs><script><block s="doIf"><block s="reportOr"><block s="reportEquals"><block var="tw"/><l></l></block><block s="reportEquals"><block var="tw"/><block s="reportNewList"><list></list></block></block></block><script><block s="doReport"><l></l></block></script></block><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>tw</l></list><l>obj = JSON.parse(tw); if(!obj || !obj.coordinates ) { return ""; } obj = obj.coordinates.coordinates; return obj[0] + &apos;,&apos; + obj[1];</l></block><list><block var="tw"/></list></block></block></script></block-definition><block-definition s="twitter: end helper" type="command" category="control"><header></header><code></code><inputs></inputs><script><custom-block s="twitter: execute helper command %s"><l>endHelper</l></custom-block></script></block-definition><block-definition s="twitter: read %&apos;attribute&apos; from tweet %&apos;tw&apos;" type="reporter" category="sensing"><header></header><code></code><inputs><input type="%txt"></input><input type="%s"></input></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>tw</l><l>attrib</l></list><l>obj = JSON.parse(tw); return obj[attrib];</l></block><list><block var="tw"/><block var="attribute"/></list></block></block></script></block-definition><block-definition s="twitter: next tweet matching condition %&apos;c&apos;" type="reporter" category="sensing"><header></header><code></code><inputs><input type="%predRing"></input></inputs><script><block s="doDeclareVariables"><list><l>tw</l></list></block><block s="doForever"><script><block s="doSetVar"><l>tw</l><custom-block s="twitter: get tweet as JSON"></custom-block></block><block s="doIfElse"><block s="reportEquals"><l>tw</l><l></l></block><script><block s="doReport"><l></l></block></script><script><block s="doIf"><block s="evaluate"><block var="c"/><list><block var="tw"/></list></block><script><block s="doReport"><block var="tw"/></block></script></block></script></block></script></block></script></block-definition><block-definition s="for each tweet do %&apos;c&apos;" type="command" category="control"><header></header><code></code><inputs><input type="%cs"></input></inputs><script><block s="doDeclareVariables"><list><l>buf</l></list></block><block s="doForever"><script><block s="doWarp"><script><block s="doSetVar"><l>buf</l><custom-block s="twitter: get tweet as JSON"></custom-block></block><block s="doIf"><block s="reportGreaterThan"><block s="reportStringSize"><custom-block s="twitter: read text from tweet %s"><block var="buf"/></custom-block></block><l>0</l></block><script><block s="doRun"><block var="c"/><list><block var="buf"/></list></block></script></block></script></block></script></block></script></block-definition><block-definition s="bar with height %&apos;h&apos; width %&apos;w&apos;" type="command" category="pen"><header></header><code></code><inputs><input type="%n"></input><input type="%n"></input></inputs><script><block s="down"></block><block s="doWarp"><script><block s="doRepeat"><block var="w"/><script><block s="setHeading"><l>0</l></block><block s="forward"><block var="h"/></block><block s="turn"><l>90</l></block><block s="forward"><l>1</l></block><block s="turn"><l>90</l></block><block s="forward"><block var="h"/></block></script></block></script></block><block s="up"></block></script></block-definition><block-definition s="bar chart with values %&apos;l&apos;" type="command" category="pen"><header></header><code></code><inputs><input type="%l"></input></inputs><script><block s="doDeclareVariables"><list><l>bars</l><l>barWidth</l><l>chartWidth</l><l>chartHeight</l><l>maxValue</l></list></block><block s="doSetVar"><l>chartWidth</l><l>400</l></block><block s="doSetVar"><l>chartHeight</l><l>290</l></block><block s="doSetVar"><l>bars</l><block s="reportListLength"><block var="l"/></block></block><block s="doSetVar"><l>barWidth</l><block s="reportQuotient"><block s="reportQuotient"><block var="chartWidth"/><block var="bars"/></block><l>1.5</l></block></block><block s="doSetVar"><l>maxValue</l><custom-block s="get maximum from list %l"><block var="l"/></custom-block></block><block s="hide"></block><block s="gotoXY"><block s="reportDifference"><l>0</l><block s="reportQuotient"><block var="chartWidth"/><l>2</l></block></block><block s="reportDifference"><l>0</l><block s="reportQuotient"><block var="chartHeight"/><l>2</l></block></block></block><block s="setSize"><l>12</l></block><block s="setColor"><color>0,14,143,1</color></block><block s="clear"></block><block s="doRepeat"><block var="bars"/><script><custom-block s="bar with height %n width %n"><block s="reportProduct"><block s="reportQuotient"><block s="reportListItem"><l>1</l><block var="l"/></block><block var="maxValue"/></block><block var="chartHeight"/></block><block var="barWidth"/></custom-block><block s="doDeleteFromList"><l>1</l><block var="l"/></block><block s="setHeading"><l>90</l></block><block s="forward"><block s="reportQuotient"><block var="barWidth"/><l>2</l></block></block><block s="changeHue"><l>17</l></block></script></block></script></block-definition><block-definition s="get maximum from list %&apos;l&apos;" type="reporter" category="lists"><header></header><code></code><inputs><input type="%l"></input></inputs><script><block s="doDeclareVariables"><list><l>i</l><l>max</l></list></block><block s="doSetVar"><l>i</l><l>1</l></block><block s="doSetVar"><l>max</l><l>0</l></block><block s="doRepeat"><block s="reportListLength"><block var="l"/></block><script><block s="doIf"><block s="reportGreaterThan"><block s="reportListItem"><block var="i"/><block var="l"/></block><block var="max"/></block><script><block s="doSetVar"><l>max</l><block s="reportListItem"><block var="i"/><block var="l"/></block></block></script></block><block s="doChangeVar"><l>i</l><l>1</l></block></script></block><block s="doReport"><block var="max"/></block></script></block-definition><block-definition s="get %&apos;attr&apos; from JSON object %&apos;obj&apos;" type="reporter" category="sensing"><header></header><code></code><inputs><input type="%s"></input><input type="%s"></input></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>attr</l><l>obj</l></list><l>return obj[attr];</l></block><list><block var="attr"/><block var="obj"/></list></block></block></script></block-definition><block-definition s="twitter: prepare" type="command" category="control"><header></header><code></code><inputs></inputs><script><block s="doDeclareVariables"><list><l>authUrl</l></list></block><block s="doUntil"><block s="reportOr"><block s="reportGreaterThan"><block s="reportStringSize"><block var="authUrl"/></block><l>5</l></block><l/></block><script><block s="doSetVar"><l>authUrl</l><block s="reportURL"><block s="reportJoinWords"><list><custom-block s="twitter: helper url"></custom-block><l>auth</l></list></block></block></block></script></block><block s="doIf"><block s="reportNot"><block s="reportEquals"><block var="authUrl"/><l>//NOAUTH//</l></block></block><script><block s="doRun"><block s="reportJSFunction"><list><l>url</l></list><l>window.open(url);</l></block><list><block var="authUrl"/></list></block></script></block><block s="doUntil"><block s="reportEquals"><block s="reportURL"><block s="reportJoinWords"><list><custom-block s="twitter: helper url"></custom-block><l>loginReady</l></list></block></block><l>true</l></block><script><block s="doWait"><l>1</l></block></script></block></script></block-definition><block-definition s="twitter: connect to stream" type="command" category="control"><header></header><code></code><inputs></inputs><script><custom-block s="twitter: execute helper command %s"><l>connect</l></custom-block><block s="doWait"><l>2</l></block></script></block-definition><block-definition s="twitter: execute helper command %&apos;c&apos;" type="command" category="other"><header></header><code></code><inputs><input type="%s"></input></inputs><script><block s="doDeclareVariables"><list><l>return</l></list></block><block s="doSetVar"><l>return</l><block s="reportURL"><block s="reportJoinWords"><list><custom-block s="twitter: helper url"></custom-block><block var="c"/></list></block></block></block><block s="doIf"><custom-block s="text %s starts with %s"><block var="return"/><l>ERR</l></custom-block><script><custom-block s="alert %s"><block var="return"/></custom-block></script></block></script></block-definition><block-definition s="twitter: helper url" type="reporter" category="other"><header></header><code></code><inputs></inputs><script><block s="doReport"><l>localhost:13337/</l><comment w="90" collapsed="false">should end with &apos;/&apos;</comment></block></script></block-definition><block-definition s="twitter: disconnect from stream" type="command" category="control"><header></header><code></code><inputs></inputs><script><custom-block s="twitter: execute helper command %s"><l>disconnect</l></custom-block></script></block-definition><block-definition s="twitter: active filters" type="reporter" category="control"><header></header><code></code><inputs></inputs><script><block s="doReport"><custom-block s="twitter: get from helper command %s"><l>getActiveFilters</l></custom-block></block></script></block-definition><block-definition s="twitter: get from helper command %&apos;c&apos;" type="reporter" category="other"><header></header><code></code><inputs><input type="%s"></input></inputs><script><block s="doReport"><block s="reportURL"><block s="reportJoinWords"><list><custom-block s="twitter: helper url"></custom-block><block var="c"/></list></block></block></block></script></block-definition><block-definition s="twitter: set language filter to %&apos;langs&apos;" type="command" category="control"><header></header><code></code><inputs><input type="%s"></input></inputs><script><custom-block s="twitter: execute helper command %s"><block s="reportJoinWords"><list><l>setLanguageFilter/</l><block var="langs"/></list></block></custom-block></script></block-definition><block-definition s="twitter: set keyword filter to %&apos;keywords&apos;" type="command" category="control"><header></header><code></code><inputs><input type="%s"></input></inputs><script><custom-block s="twitter: execute helper command %s"><block s="reportJoinWords"><list><l>setKeywordFilter/</l><block var="keywords"/></list></block></custom-block></script></block-definition><block-definition s="twitter: set geo filter to %&apos;geo&apos;" type="command" category="control"><header></header><code></code><inputs><input type="%s"></input></inputs><script><custom-block s="twitter: execute helper command %s"><block s="reportJoinWords"><list><l>setGeoFilter/</l><block var="geo"/></list></block></custom-block></script></block-definition><block-definition s="twitter: set geo filter to &quot;all with geo information&quot;" type="command" category="control"><header></header><code></code><inputs></inputs><script><custom-block s="twitter: execute helper command %s"><l>setGeoFilter/allWithGeo</l></custom-block></script></block-definition><block-definition s="twitter: remove language filter" type="command" category="control"><header></header><code></code><inputs></inputs><script><custom-block s="twitter: execute helper command %s"><l>setLanguageFilter/none</l></custom-block></script></block-definition><block-definition s="twitter: remove keyword filter" type="command" category="control"><header></header><code></code><inputs></inputs><script><custom-block s="twitter: execute helper command %s"><l>setKeywordFilter/none</l></custom-block></script></block-definition><block-definition s="twitter: remove geo filter" type="command" category="control"><header></header><code></code><inputs></inputs><script><custom-block s="twitter: execute helper command %s"><l>setGeoFilter/none</l></custom-block></script></block-definition><block-definition s="alert %&apos;txt&apos;" type="command" category="other"><header></header><code></code><inputs><input type="%s"></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>txt</l></list><l>alert(txt);</l></block><list><block var="txt"/></list></block></script></block-definition><block-definition s="text %&apos;t&apos; starts with %&apos;x&apos;" type="predicate" category="operators"><header></header><code></code><inputs><input type="%s"></input><input type="%s"></input></inputs><script><block s="doIf"><block s="reportEquals"><block s="evaluate"><block s="reportJSFunction"><list><l>t</l><l>x</l></list><l>return t.startsWith(x);</l></block><list><block var="t"/><block var="x"/></list></block><block s="reportTrue"></block></block><script><block s="doReport"><block s="reportTrue"></block></block></script></block><block s="doReport"><block s="reportFalse"></block></block></script></block-definition><block-definition s="stamp image from %&apos;url&apos;" type="command" category="pen"><header></header><code></code><inputs><input type="%s"></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>url</l></list><l>// Implementation of this function&#xD;// (c) Bernat Romagosa for http://snapi.citilab.eu&#xD;&#xD;jthis = this;&#xD;&#xD;var sprite = this,&#xD;&#xD;&#xD;&#xD;&#xD;    stage = sprite.parentThatIsA(StageMorph),&#xD;&#xD;&#xD;&#xD;&#xD;    context = stage.penTrails().getContext(&apos;2d&apos;),&#xD;&#xD;&#xD;&#xD;&#xD;    isWarped = sprite.isWarped,&#xD;&#xD;&#xD;&#xD;&#xD;    img = new Image(),&#xD;&#xD;&#xD;&#xD;&#xD;    left = sprite.center().x - stage.left(),&#xD;&#xD;&#xD;&#xD;&#xD;    top = sprite.center().y - stage.top();&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;if (isWarped) {&#xD;&#xD;&#xD;&#xD;&#xD;	sprite.endWarp();&#xD;&#xD;&#xD;&#xD;&#xD;}&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;img.src = url;&#xD;&#xD;&#xD;&#xD;&#xD;context.save();&#xD;&#xD;&#xD;&#xD;&#xD;context.scale(1 / stage.scale, 1 / stage.scale);&#xD;&#xD;&#xD;&#xD;&#xD;context.translate(left, top);&#xD;&#xD;&#xD;&#xD;&#xD;context.rotate((sprite.heading - 90) * Math.PI/180);&#xD;&#xD;&#xD;&#xD;&#xD;context.drawImage(img,&#xD;&#xD;&#xD;&#xD;0,&#xD;&#xD;&#xD;&#xD;0);&#xD;&#xD;&#xD;&#xD;&#xD;context.restore();&#xD;&#xD;&#xD;&#xD;&#xD;stage.changed();&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;if (isWarped) {&#xD;&#xD;&#xD;&#xD;&#xD;		sprite.startWarp();&#xD;&#xD;&#xD;&#xD;&#xD;}</l></block><list><block var="url"/></list></block></script></block-definition><block-definition s="twitter: get map image" type="reporter" category="other"><header></header><code></code><inputs></inputs><script><block s="doReport"><custom-block s="twitter: get from helper command %s"><l>getMap</l></custom-block></block></script></block-definition><block-definition s="twitter: stamp map image" type="command" category="pen"><header></header><code></code><inputs></inputs><script><block s="setHeading"><l>90</l></block><block s="gotoXY"><l>-240</l><l>180</l></block><custom-block s="stamp image from %s"><custom-block s="twitter: get map image"></custom-block></custom-block></script></block-definition><block-definition s="show marker at longitude %&apos;long&apos; latitude %&apos;lat&apos;" type="command" category="pen"><header></header><code></code><inputs><input type="%s"></input><input type="%s"></input></inputs><script><block s="doDeclareVariables"><list><l>ax</l><l>ay</l><l>bx</l><l>by</l></list></block><block s="up"></block><block s="doSetVar"><l>ax</l><l>0.7501</l></block><block s="doSetVar"><l>ay</l><l>0.5841</l></block><block s="doSetVar"><l>bx</l><l>-1.7676</l></block><block s="doSetVar"><l>by</l><l>3.2060</l></block><block s="gotoXY"><block s="reportQuotient"><block s="reportSum"><block var="long"/><block var="bx"/></block><block var="ax"/></block><block s="reportQuotient"><block s="reportSum"><block var="lat"/><block var="by"/></block><block var="ay"/></block></block><block s="setSize"><l>7</l></block><block s="down"></block><block s="doRepeat"><l>5</l><script><block s="forward"><l>1</l></block><block s="turn"><l>72</l></block></script></block><block s="up"></block></script></block-definition><block-definition s="twitter: open sample project" type="command" category="other"><header></header><code></code><inputs></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>url</l></list><l>window.location.href=url;</l></block><list><block s="reportJoinWords"><list><l>http://</l><custom-block s="twitter: helper url"></custom-block><l>loadExample</l></list></block></list></block></script></block-definition></blocks><variables></variables></project>